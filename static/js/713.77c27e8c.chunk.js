"use strict";(self.webpackChunktiktok=self.webpackChunktiktok||[]).push([[713],{5713:function(e,n,t){t.r(n),t.d(n,{default:function(){return ie}});var i=t(4165),r=t(2982),s=t(5861),o=t(885),a=t(9448),c=t.n(a),l=t(5671),u=t(3144),d=t(136),h=t(516),v=t(2791);function p(){return p=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},p.apply(this,arguments)}var m=new Map,f=new WeakMap,_=0,x=void 0;function b(e){return Object.keys(e).sort().filter((function(n){return void 0!==e[n]})).map((function(n){return"".concat(n,"_").concat("root"===n?(t=e.root)?(f.has(t)||(_+=1,f.set(t,_.toString())),f.get(t)):"0":e[n]);var t})).toString()}function g(e){var n=b(e),t=m.get(n);if(!t){var i,r=new Map,s=new IntersectionObserver((function(n){n.forEach((function(n){var t,s=n.isIntersecting&&i.some((function(e){return n.intersectionRatio>=e}));e.trackVisibility&&"undefined"===typeof n.isVisible&&(n.isVisible=s),null==(t=r.get(n.target))||t.forEach((function(e){e(s,n)}))}))}),e);i=s.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:s,elements:r},m.set(n,t)}return t}function j(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;if("undefined"===typeof window.IntersectionObserver&&void 0!==i){var r=e.getBoundingClientRect();return n(i,{isIntersecting:i,target:e,intersectionRatio:"number"===typeof t.threshold?t.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),function(){}}var s=g(t),o=s.id,a=s.observer,c=s.elements,l=c.get(e)||[];return c.has(e)||c.set(e,l),l.push(n),a.observe(e),function(){l.splice(l.indexOf(n),1),0===l.length&&(c.delete(e),a.unobserve(e)),0===c.size&&(a.disconnect(),m.delete(o))}}var y=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function k(e){return"function"!==typeof e.children}var w=function(e){(0,d.Z)(t,e);var n=(0,h.Z)(t);function t(e){var i;return(0,l.Z)(this,t),(i=n.call(this,e)).node=null,i._unobserveCb=null,i.handleNode=function(e){i.node&&(i.unobserve(),e||i.props.triggerOnce||i.props.skip||i.setState({inView:!!i.props.initialInView,entry:void 0})),i.node=e||null,i.observeNode()},i.handleChange=function(e,n){e&&i.props.triggerOnce&&i.unobserve(),k(i.props)||i.setState({inView:e,entry:n}),i.props.onChange&&i.props.onChange(e,n)},i.state={inView:!!e.initialInView,entry:void 0},i}return(0,u.Z)(t,[{key:"componentDidUpdate",value:function(e){e.rootMargin===this.props.rootMargin&&e.root===this.props.root&&e.threshold===this.props.threshold&&e.skip===this.props.skip&&e.trackVisibility===this.props.trackVisibility&&e.delay===this.props.delay||(this.unobserve(),this.observeNode())}},{key:"componentWillUnmount",value:function(){this.unobserve(),this.node=null}},{key:"observeNode",value:function(){if(this.node&&!this.props.skip){var e=this.props,n=e.threshold,t=e.root,i=e.rootMargin,r=e.trackVisibility,s=e.delay,o=e.fallbackInView;this._unobserveCb=j(this.node,this.handleChange,{threshold:n,root:t,rootMargin:i,trackVisibility:r,delay:s},o)}}},{key:"unobserve",value:function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}},{key:"render",value:function(){if(!k(this.props)){var e=this.state,n=e.inView,t=e.entry;return this.props.children({inView:n,entry:t,ref:this.handleNode})}var i=this.props,r=i.children,s=i.as,o=function(e,n){if(null==e)return{};var t,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)t=s[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(i,y);return v.createElement(s||"div",p({ref:this.handleNode},o),r)}}]),t}(v.Component);var N={wrapper:"VideoItem_wrapper__SalTZ",main:"VideoItem_main__Ou-lo","place-video":"VideoItem_place-video__2aHot",video:"VideoItem_video__Y9-WQ",action:"VideoItem_action__Yd427","play-or-pause":"VideoItem_play-or-pause__lRTuS",volume:"VideoItem_volume__RQjU0","volume-bar":"VideoItem_volume-bar__orlnG","vol-icon":"VideoItem_vol-icon__Z7PqU"},C=t(3395),V=t(4307),Z=t(4483),I=t(1632),S=t(184),G=c().bind(N);var O=function(e){var n=e.isPlay,t=e.handlePlayOrPause,i=e.volume,r=e.handleChangeVol,s=e.handleVol;return(0,S.jsxs)("div",{className:G("action"),children:[(0,S.jsx)("button",{className:G("play-or-pause"),onClick:t,children:n?(0,S.jsx)(Z.G,{icon:I.XQY}):(0,S.jsx)(Z.G,{icon:I.zc})}),(0,S.jsxs)("div",{className:G("volume"),children:[(0,S.jsx)("div",{className:G("volume-bar"),children:(0,S.jsx)("input",{type:"range",min:"0",max:"100",value:100*i,onChange:r})}),(0,S.jsx)("button",{className:G("vol-icon"),onClick:s,children:i>0?(0,S.jsx)(Z.G,{icon:I.AQZ}):(0,S.jsx)(Z.G,{icon:I.c0k})})]})]})},E=t(1413),H=t(1087),P=t(8858),U=(t(4992),t(5839)),L=t(1663),R=t(9625),q=t(5768),M=t(5263),T=t(1313),A=t(1519),Q=c().bind({header:"Header_header__yB3tm",desc:"Header_desc__qrmPi",avatar:"Header_avatar__LeiA+",content:"Header_content__XKL5C",info:"Header_info__d4a27",nickname:"Header_nickname__D0yLw",icon:"Header_icon__wNHnS",name:"Header_name__Gy5p2",text:"Header_text__L3NdS",hashtag:"Header_hashtag__Rqf4a",music:"Header_music__PE5FJ","icon-music":"Header_icon-music__Vw0Aw"});var Y=function(e){var n=e.user,t=e.music,i=e.desc,r=(0,v.useContext)(M.u).show,s=(0,v.useContext)(T.m).isLogin,a=(0,v.useState)(""),c=(0,o.Z)(a,2),l=c[0],u=c[1],d=(0,v.useState)([]),h=(0,o.Z)(d,2),p=h[0],m=h[1];return(0,v.useLayoutEffect)((function(){i.includes("#")?(m(i.split("#").slice(1)),u(i.substring(0,i.indexOf("#")))):u(i)}),[]),(0,S.jsxs)("header",{className:Q("header"),children:[(0,S.jsxs)("div",{className:Q("desc"),children:[(0,S.jsx)(P.ZP,{interactive:!0,delay:[800,0],render:function(e){return(0,S.jsx)("div",(0,E.Z)((0,E.Z)({tabIndex:"-1"},e),{},{children:(0,S.jsx)(L.i,{children:(0,S.jsx)(q.Z,{data:n})})}))},placement:"bottom-start",offset:[-18,-4],children:(0,S.jsx)(U.Z,{className:Q("avatar"),src:n.avatar,alt:"",size:"54px"})}),(0,S.jsxs)("div",{className:Q("content"),children:[(0,S.jsxs)(H.rU,{to:"/",className:Q("info"),children:[(0,S.jsx)("strong",{className:Q("nickname"),children:n.nickname}),n.tick&&(0,S.jsx)(Z.G,{icon:I.fV7,className:Q("icon")}),(0,S.jsx)("p",{className:Q("name"),children:n.first_name+n.last_name})]}),(0,S.jsxs)("p",{className:Q("text"),children:[l,p.map((function(e,n){return(0,S.jsx)(A.Z,{className:Q("hashtag"),children:e},n)}))]}),(0,S.jsxs)(H.rU,{to:"/",className:Q("music"),children:[(0,S.jsx)(Z.G,{icon:I.Xig,className:Q("icon-music")}),(0,S.jsx)("p",{children:t})]})]})]}),(0,S.jsx)("div",{children:(0,S.jsx)(R.Z,{outline:!0,onClick:s?function(){}:r,children:"Follow"})})]})},z=c().bind({wrapper:"Share_wrapper__jtU6i",item:"Share_item__qERxI",icon:"Share_icon__VLEix",title:"Share_title__PRrOA",btn:"Share_btn__ccnmr"});var B=function(e){var n=e.data,t=(0,v.useState)(n.slice(0,4)),i=(0,o.Z)(t,2),r=i[0],s=i[1],a=(0,v.useState)(!1),c=(0,o.Z)(a,2),l=c[0],u=c[1];return(0,S.jsxs)("div",{className:z("wrapper"),children:[r.map((function(e,n){return(0,S.jsxs)(H.rU,{className:z("item"),children:[(0,S.jsx)("div",{style:{backgroundColor:e.bgc},className:z("icon"),children:e.icon}),(0,S.jsx)("p",{className:z("title"),children:e.title})]},n)})),l?(0,S.jsx)("button",{className:z("btn"),onClick:function(){u(!1),s(n.slice(0,4))},children:(0,S.jsx)(Z.G,{icon:I.mTx})}):(0,S.jsx)("button",{className:z("btn"),onClick:function(){u(!0),s(n)},children:(0,S.jsx)(Z.G,{icon:I.ptq})})]})},X=t(1187),F=c().bind({"place-interactive":"Interactive_place-interactive__hQ-hO",heart:"Interactive_heart__4YNUr",comment:"Interactive_comment__rGj1K",share:"Interactive_share__9GqZE",quantity:"Interactive_quantity__ELb2Z"}),K=[{icon:(0,S.jsx)(Z.G,{icon:I.dT$}),title:"Embed",bgc:"#161823"},{icon:(0,S.jsx)(Z.G,{icon:I.M6U}),title:"Send to friends",bgc:"rgb(254, 44, 85)"},{icon:(0,S.jsx)(Z.G,{icon:X.AYu}),title:"Share to facebook",bgc:"#20d5ec"},{icon:(0,S.jsx)(Z.G,{icon:X.VHX}),title:"Share to whatsApp",bgc:"rgb(37, 211, 102)"},{icon:(0,S.jsx)(Z.G,{icon:I.nNP}),title:"Copy link",bgc:"rgb(254, 44, 85)"},{icon:(0,S.jsx)(Z.G,{icon:X.mdU}),title:"Share to twitter",bgc:"rgb(29, 161, 242)"},{icon:(0,S.jsx)(Z.G,{icon:X.hwn}),title:"Share to linked",bgc:"rgb(10, 102, 194)"},{icon:(0,S.jsx)(Z.G,{icon:X.Uv8}),title:"Share to Telegram",bgc:"rgb(29, 161, 242)"},{icon:(0,S.jsx)(Z.G,{icon:I.FU$}),title:"Share to whatsApp",bgc:"rgb(29, 161, 242)"}];var W=function(e){var n=e.likesCount,t=e.commentCount,i=e.sharesCount;return(0,S.jsxs)("div",{className:F("place-interactive"),children:[(0,S.jsx)("button",{className:F("heart"),children:(0,S.jsx)(Z.G,{icon:I.m6i})}),(0,S.jsx)("p",{className:F("quantity"),children:n}),(0,S.jsx)("button",{className:F("comment"),children:(0,S.jsx)(Z.G,{icon:I.Z6I})}),(0,S.jsx)("p",{className:F("quantity"),children:t}),(0,S.jsx)(P.ZP,{interactive:!0,render:function(e){return(0,S.jsx)("div",(0,E.Z)((0,E.Z)({tabIndex:"-1"},e),{},{children:(0,S.jsx)(L.i,{children:(0,S.jsx)(B,{data:K})})}))},placement:"top-start",offset:[-20,4],delay:[0,400],children:(0,S.jsx)("button",{className:F("share"),children:(0,S.jsx)(Z.G,{icon:I.zBy})})}),(0,S.jsx)("p",{className:F("quantity"),children:i})]})},D=c().bind(N);var $=function(e){var n=e.data,t=(0,v.useContext)(V.s),i=t.playVideo,r=t.setPlayVideo,s=(0,v.useContext)(C.i),a=s.volume,c=s.setVolume,l=(0,v.useRef)(null),u=(0,v.useState)(!1),d=(0,o.Z)(u,2),h=d[0],p=d[1];(0,v.useMemo)((function(){i&&null!==l.current&&(i===n.id?l.current.play():(p(!1),l.current.pause(),l.current.currentTime=0))}),[i]);var m=function(){return h?l.current.pause():(r(n.id),l.current.play()),p(!h)};return(0,S.jsxs)("div",{className:D("wrapper"),children:[(0,S.jsx)(Y,{user:n.user,desc:n.description,music:n.music}),(0,S.jsxs)("div",{className:D("main"),children:[(0,S.jsx)("div",{className:D("place-video"),children:(0,S.jsxs)(w,{onChange:function(e,n){e?(l.current.play(),p(!0)):(l.current.pause(),p(!1))},style:{height:"100%"},children:[(0,S.jsx)("video",{onTimeUpdate:function(e){e.target.volume=a},onClick:m,ref:l,className:D("video"),src:n.file_url,onEnded:function(e){e.target.currentTime=0,e.target.play()}}),(0,S.jsx)(O,{isPlay:h,handleChangeVol:function(e){var n=e.target.value/100;c(n)},handlePlayOrPause:m,handleVol:function(){a>0&&(c(0),c(1))},volume:a})]})}),(0,S.jsx)(W,{likesCount:n.likes_count,commentCount:n.comments_count,shareCount:n.share_count})]})]})},J=t(9417),ee=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var n,t,r,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>0&&void 0!==s[0]?s[0]:1,t=s.length>1&&void 0!==s[1]?s[1]:"for-you",e.prev=2,e.next=5,J.U("videos",{params:{page:n,type:t}});case 5:return r=e.sent,e.abrupt("return",r.data);case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),ne=c().bind({home:"Home_home__gGfTK"});function te(){var e=(0,v.useState)([]),n=(0,o.Z)(e,2),t=n[0],a=n[1],c=(0,v.useState)(1),l=(0,o.Z)(c,2),u=l[0],d=l[1],h=(0,v.useRef)(),p=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var n,t,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>0&&void 0!==s[0]?s[0]:"for-you",window.removeEventListener("scroll",m),e.next=4,ee(u,n);case 4:t=e.sent,a((function(e){return[].concat((0,r.Z)(e),(0,r.Z)(t))})),window.addEventListener("scroll",m);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){return p("for-you"),window.addEventListener("scroll",m),window.removeEventListener("scroll",m)}),[u]);var m=function(){var e=h.current.scrollHeight||1;e>0&&document.documentElement.scrollTop>e-900&&d(u+1)};return(0,S.jsx)("div",{className:ne("home"),ref:h,children:t.map((function(e,n){return(0,S.jsx)($,{data:e},n)}))})}var ie=(0,v.memo)(te)}}]);
//# sourceMappingURL=713.77c27e8c.chunk.js.map